import socket
import sys

target = input("Your target IPv4 address:\n")
ports_start = input("Start port:\n")
ports_end = input("End Port:\n")

def port_scan(target,ports_start, ports_end):
    for port in range(int(ports_start), int(ports_end) + 1):
        try:
            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            sock.settimeout(0.2)
            result = sock.connect_ex((target,port))
            if result ==0:
                print(f"Port {port} is open!")
                banner = sock.recv(1024).decode("utf-8").strip()
                try:
                    print(f"Banner for port {port}: {banner}")
                except socket.error:
                    pass
                finally:
                    sock.close()
        except KeyboardInterrupt:
            print("Exiting...")
            sys.exit()
        except socket.gaierror:
            print("Host could not be resolved.")
            sys.exit()
        except socket.error:
            print("Couldn't connect server")
            sys.exit()

start = port_scan(target, ports_start, ports_end)